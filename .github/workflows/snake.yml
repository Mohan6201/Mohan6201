name: 🐍 Generate Custom Snake via Docker

on:
  schedule:
    - cron: '0 0 * * *'   # every day at midnight UTC
  workflow_dispatch:
  push:
    branches: [ master ]

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: ⬇️ Checkout Repository
        uses: actions/checkout@v3

      - name: 📁 Ensure output folder
        run: mkdir -p dist

      - name: 🐳 Generate Snake SVG (via Docker)
        run: |
          docker run --rm \
            -v "${{ github.workspace }}/dist:/out" \
            platane/snk:3.0.0 \
            Mohan6201 \
            --format svg \
            --snake-color "#FF4500" \
            --bg-color "transparent" \
            --day-labels "Mon,Tue,Wed,Thu,Fri,Sat,Sun" \
            --month-labels "Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec" \
            --show-year \
            --out /out/github-snake.svg

      - name: 🚀 Deploy to GitHub Pages
        uses: crazy-max/ghaction-github-pages@v3.1.0
        with:
          target_branch: output
          build_dir: dist
          commit_message: "✨ Auto-update custom snake"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
